<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="vercel.xhtml">

    <ui:define name="content">
        <h:form id="formCampeonato" enctype="multipart/form-data">
                                   
            <!-- Header Glass -->
            <p:card styleClass="glass-card mb-4">
                <div class="flex justify-content-between align-items-center flex-wrap gap-3">
                    <div class="flex-1">
                        <div class="flex align-items-center mb-2">
                            <i class="pi pi-trophy mr-3" style="font-size: 1.8rem; color: var(--accent)"></i>
                            <h1 class="m-0" style="font-weight: 800; font-size: 1.8rem; color: var(--text-100)">Criar Novo Campeonato</h1>
                        </div>
                        <p class="m-0" style="color: #d1d8e6">Preencha as informações para criar um novo campeonato</p>
                    </div>
                </div>
            </p:card>

            <!-- Card: Informações Básicas -->
            <p:card styleClass="glass-card mb-4">
                <f:facet name="title">
                    <div class="flex align-items-center">
                        <i class="pi pi-info-circle mr-2" style="color: var(--accent)"></i>
                        <span>Informações Básicas</span>
                    </div>
                </f:facet>

                <div class="formgrid grid">
                    <!-- Nome -->
                    <div class="field col-12 md:col-8">
                        <label for="campNome" class="block mb-2 font-medium" style="color: #cbd5e1">Nome do Campeonato *</label>
                        <p:inputText id="campNome" 
                                     value="#{managerCriarCampeonato.camp.nome}"
                                     placeholder="Ex: Campeonato Brasileiro 2024"
                                     required="true"
                                     requiredMessage="Nome é obrigatório"
                                     styleClass="glass-input w-full" />
                    </div>

                    <!-- Status -->
                    <div class="field col-12 md:col-4">
                        <label for="campStatus" class="block mb-2 font-medium" style="color: #cbd5e1">Status *</label>
                        <p:selectOneMenu id="campStatus" 
                                         value="#{managerCriarCampeonato.camp.status}"
                                         required="true"
                                         requiredMessage="Status é obrigatório"
                                         styleClass="w-full">
                            <f:selectItem itemLabel="Selecione" itemValue="" noSelectionOption="true" />
                            <f:selectItems value="#{enums.statusCamp()}" />
                        </p:selectOneMenu>
                    </div>

                    <!-- Data Início -->
                    <div class="field col-12 md:col-4">
                        <label for="campDataInicio" class="block mb-2 font-medium" style="color: #cbd5e1">Data de Início *</label>
                        <p:datePicker id="campDataInicio" 
                                      value="#{managerCriarCampeonato.camp.dataCamp}" 
                                      pattern="dd/MM/yyyy HH:mm" 
                                      hourFormat="24" 
                                      showIcon="true" 
                                      showTime="true" 
                                      styleClass="w-full" />
                    </div>

                    <!-- Data Final -->
                    <div class="field col-12 md:col-4">
                        <label for="campDataFinal" class="block mb-2 font-medium" style="color: #cbd5e1">Término das Inscrições *</label>
                        <p:datePicker id="campDataFinal" 
                                      value="#{managerCriarCampeonato.camp.dataPrazoCamp}" 
                                      pattern="dd/MM/yyyy HH:mm" 
                                      hourFormat="24" 
                                      showIcon="true" 
                                      showTime="true" 
                                      styleClass="w-full" />
                    </div>

                    <!-- Jogo -->
                    <div class="field col-12 md:col-4">
                        <label for="campJogo" class="block mb-2 font-medium" style="color: #cbd5e1">Jogo *</label>
                        <p:autoComplete id="campJogo" 
                                        value="#{managerCriarCampeonato.camp.jogo}"
                                        forceSelection="true" 
                                        dropdown="true" 
                                        var="jogo" 
                                        itemValue="#{jogo}" 
                                        scrollHeight="200"
                                        itemLabel="#{jogo.nome}" 
                                        completeMethod="#{managerAutoCompletes.autoCompletaJogos()}"
                                        converter="jogo_converter"
                                        styleClass="w-full" />
                    </div>
                </div>
            </p:card>

            <div class="grid">
                <!-- Card: Configurações -->
                <div class="col-12 lg:col-6">
                    <p:card styleClass="glass-card h-full">
                        <f:facet name="title">
                            <div class="flex align-items-center">
                                <i class="pi pi-cog mr-2" style="color: var(--accent)"></i>
                                <span>Configurações</span>
                            </div>
                        </f:facet>

                        <!-- Categoria -->
                        <div class="field mb-4">
                            <label for="campCategoria" class="block mb-3 font-medium" style="color: #cbd5e1">Categoria *</label>
                            <p:selectOneButton id="campCategoria" 
                                               value="#{managerCriarCampeonato.camp.categoria}"
                                               required="true"
                                               requiredMessage="Categoria é obrigatória">
                                <f:selectItem itemLabel="Individual" itemValue="INDIVIDUAL" />
                                <f:selectItem itemLabel="Times" itemValue="TIME" />
                                <p:ajax update="configTimesPanel" />
                            </p:selectOneButton>
                            <small class="block mt-2" style="color: #98a2b3">
                                Defina se será individual ou por times
                            </small>
                        </div>

                        <!-- Configurações de Times (condicional) -->
                        <h:panelGroup id="configTimesPanel">
                            <h:panelGroup rendered="#{managerCriarCampeonato.camp.categoria eq 'TIME'}">
                                <p:divider />
                                
                                <!-- Geração de Times por Sorteio -->
                                <div class="field mb-4">
                                    <label class="block mb-3 font-medium" style="color: #cbd5e1">Geração de Times</label>
                                    
                                    <div class="config-box mb-3">
                                        <div class="flex align-items-center gap-2 mb-3">
                                            <p:selectBooleanCheckbox id="sorteioTimes" 
                                                                     value="#{managerCriarCampeonato.camp.gerarTimesPorSorteio}">
                                                
                                            </p:selectBooleanCheckbox>
                                            <label for="sorteioTimes" class="font-medium cursor-pointer" style="color: var(--text-100)">
                                                Gerar times automaticamente por sorteio
                                            </label>
                                        </div>
                                        
                                        <small class="block" style="color: #98a2b3">
                                            <i class="pi pi-info-circle mr-1"></i>
                                            Quando ativado, os jogadores inscritos serão distribuídos automaticamente entre os times através de sorteio
                                        </small>
                                    </div>

                                </div>
                                <p:divider />
                                
                                <!-- Quantidade de Jogadores por Time -->
                                <div class="field mb-4">
                                    <label for="qtdJogadoresTime" class="block mb-3 font-medium" style="color: #cbd5e1">
                                        <i class="pi pi-users mr-2"></i>Jogadores por Time
                                    </label>
                                    <p:inputNumber id="qtdJogadoresTime" 
                                                   value="#{managerCriarCampeonato.camp.quantidadePorTime}"                                                   
                                                   placeholder="Ex: 5"                                                   
                                                   styleClass="w-full">
                                       
                                    </p:inputNumber>
                                </div>

                            </h:panelGroup>
                        </h:panelGroup>

                        <p:divider />

                        <!-- Formato -->
                        <div class="field">
                            <label for="campTipo" class="block mb-3 font-medium" style="color: #cbd5e1">Formato *</label>
                            <div class="flex flex-column gap-3">
                                <p:selectOneRadio id="campTipo" 
                                                  value="#{managerCriarCampeonato.camp.tipoCampeonato}"
                                                  required="true"
                                                  requiredMessage="Formato é obrigatório">
                                    <f:selectItems value="#{enums.tipoCampeonato()}" />
                                </p:selectOneRadio>
                            </div>
                        </div>

                        <!-- Info Box -->
                        <div class="info-box mt-4">
                            <div class="flex gap-2">
                                <i class="pi pi-info-circle" style="color: var(--accent)"></i>
                                <div>
                                    <p class="font-semibold mt-0 mb-2" style="color: var(--text-100)">Sobre os formatos:</p>
                                    <ul class="mt-0 mb-0 pl-3" style="color: #d1d8e6">
                                        <li><strong>Suíço:</strong> Pontuações semelhantes se enfrentam</li>
                                        <li><strong>Mata-Mata:</strong> Eliminação direta</li>
                                        <li><strong>Pontos Corridos:</strong> Todos contra todos</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </p:card>
                </div>

                <!-- Card: Imagem e Descrição -->
                <div class="col-12 lg:col-6">
                    <p:card styleClass="glass-card h-full">
                        <f:facet name="title">
                            <div class="flex align-items-center">
                                <i class="pi pi-image mr-2" style="color: var(--accent)"></i>
                                <span>Imagem e Descrição</span>
                            </div>
                        </f:facet>

                        <!-- Preview -->
                        <div class="field mb-4">
                            <label class="block mb-3 font-medium" style="color: #cbd5e1">Logo/Banner</label>
                            
                            <p:outputPanel id="previewImagem" styleClass="block text-center mb-3">
                                <h:panelGroup rendered="#{managerCriarCampeonato.camp.anexo != null}">
                                    <p:graphicImage value="#{managerCriarCampeonato.camp.anexo.url}" 
                                                    alt="Logo"
                                                    styleClass="border-round"
                                                    style="max-width: 100%; max-height: 300px; object-fit: cover; border: 1px solid rgba(255,255,255,0.1);" />
                                </h:panelGroup>

                                <h:panelGroup rendered="#{managerCriarCampeonato.camp.anexo == null}">
                                    <div class="upload-placeholder">
                                        <div class="text-center">
                                            <i class="pi pi-image"></i>
                                            <p class="mt-2" style="color: #98a2b3">Nenhuma imagem</p>
                                        </div>
                                    </div>
                                </h:panelGroup>
                            </p:outputPanel>

                            <p:fileUpload id="uploadImagem"
                                          mode="simple" 
                                          skinSimple="true"
                                          auto="true"
                                          label="Escolher Imagem"                                         
                                          listener="#{managerCriarCampeonato.uploadImagem}"
                                          update="previewImagem"
                                          accept="image/*"
                                          invalidFileMessage="Formato inválido"
                                          invalidSizeMessage="Máximo 5MB"
                                          styleClass="w-full" />

                            <small class="block mt-2 text-center" style="color: #98a2b3">
                                JPG, PNG, GIF (máx. 5MB)
                            </small>
                        </div>

                        <p:divider />

                        <!-- Descrição -->
                        <div class="field">
                            <label for="campDescricao" class="block mb-2 font-medium" style="color: #cbd5e1">Descrição</label>
                            <p:inputTextarea id="campDescricao" 
                                             value="#{managerCriarCampeonato.camp.observacao}"
                                             rows="5" 
                                             placeholder="Informações adicionais sobre o campeonato..."
                                             autoResize="true"
                                             maxlength="500"
                                             styleClass="w-full" />
                            <small class="block mt-2" style="color: #98a2b3">Máximo 500 caracteres</small>
                        </div>
                    </p:card>
                </div>
            </div>

            <!-- Rodapé Actions -->
            <p:card styleClass="glass-card mt-4">
                <div class="flex justify-content-end gap-2">
                    <p:commandButton value="Cancelar" 
                                     icon="pi pi-times"
                                     styleClass="p-button-outlined"
                                     action="/campeonatos?faces-redirect=true"
                                     immediate="true"
                                     process="@this" />                    
                    <p:commandButton value="Criar Campeonato" 
                                     icon="pi pi-check"
                                     styleClass="full-stats-btn"
                                     action="#{managerCriarCampeonato.salvar}"
                                     update="@form"
                                     onclick="if(!confirm('Confirma a criação do campeonato?')) return false;" />
                </div>
            </p:card>

        </h:form>

        <style>
            /* Inputs glass */
            .glass-input { background: rgba(255,255,255,0.03) !important; border: 1px solid rgba(255,255,255,0.08) !important; color: var(--text-100) !important; }
            .glass-input::placeholder { color: #98a2b3; }
            .glass-input:focus { box-shadow: 0 0 0 1px rgba(0,225,255,0.18), 0 0 16px rgba(0,225,255,0.08) !important; border-color: rgba(0,225,255,0.35) !important; }
            
            /* Config box */
            .config-box { background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; padding: 1rem; }
            
            /* Info box */
            .info-box { background: rgba(0,225,255,0.05); border: 1px solid rgba(0,225,255,0.15); border-radius: 10px; padding: 1rem; }
            
            /* Upload placeholder */
            .upload-placeholder { background: rgba(255,255,255,0.02); border: 2px dashed rgba(255,255,255,0.15); border-radius: 10px; padding: 2rem; height: 300px; display: flex; align-items: center; justify-content: center; }
            .upload-placeholder i { font-size: 3rem; color: var(--muted); }

            /* SelectOneRadio dark */
            .ui-selectoneradio { background: transparent !important; }
            .ui-selectoneradio .ui-radiobutton-label { color: var(--text-100) !important; }

            /* SelectOneButton dark */
            .ui-selectonebutton { background: transparent !important; }
            .ui-selectonebutton .ui-button { background: rgba(255,255,255,0.03) !important; border-color: rgba(255,255,255,0.08) !important; color: var(--text-300) !important; }
            .ui-selectonebutton .ui-state-active { background: rgba(0,225,255,0.12) !important; border-color: rgba(0,225,255,0.35) !important; color: var(--accent) !important; }

            /* SelectOneMenu dark */
            .ui-selectonemenu { background: rgba(255,255,255,0.03) !important; border-color: rgba(255,255,255,0.08) !important; color: var(--text-100) !important; }
            .ui-selectonemenu-panel { background: var(--bg-800) !important; border-color: rgba(255,255,255,0.08) !important; }

            /* InputNumber dark */
            .ui-inputnumber { background: rgba(255,255,255,0.03) !important; border-color: rgba(255,255,255,0.08) !important; }

            /* DatePicker dark */
            .ui-calendar { background: rgba(255,255,255,0.03) !important; border-color: rgba(255,255,255,0.08) !important; }
            .ui-calendar-panel { background: var(--bg-800) !important; border-color: rgba(255,255,255,0.08) !important; }

            /* AutoComplete dark */
            .ui-autocomplete { background: rgba(255,255,255,0.03) !important; border-color: rgba(255,255,255,0.08) !important; }
            .ui-autocomplete-panel { background: var(--bg-800) !important; border-color: rgba(255,255,255,0.08) !important; }

            /* TextArea dark */
            .ui-inputtextarea { background: rgba(255,255,255,0.03) !important; border-color: rgba(255,255,255,0.08) !important; color: var(--text-100) !important; }

            /* Checkbox dark */
            .ui-chkbox { background: rgba(255,255,255,0.03) !important; border-color: rgba(255,255,255,0.08) !important; }
            .ui-chkbox .ui-chkbox-label { color: var(--text-100) !important; }

            /* FileUpload dark - Simple mode */
            .ui-fileupload-simple { background: rgba(255,255,255,0.03) !important; border: 1px solid rgba(255,255,255,0.08) !important; border-radius: 10px !important; }
            .ui-fileupload-simple:hover { background: rgba(255,255,255,0.06) !important; border-color: rgba(0,225,255,0.3) !important; }
            .ui-fileupload-simple input[type="file"] { background: transparent !important; color: var(--text-100) !important; border: none !important; padding: .5rem; }
            .ui-fileupload-simple .ui-button { background: transparent !important; border: none !important; color: var(--text-100) !important; }
            .ui-fileupload-simple .ui-button-text { color: var(--text-100) !important; }
            .ui-fileupload-simple .ui-button:hover { color: var(--accent) !important; }
            .ui-fileupload-simple .ui-icon-upload { color: var(--accent) !important; }
            
            /* Basic mode fallback */
            .ui-fileupload { background: rgba(255,255,255,0.03) !important; border: 1px solid rgba(255,255,255,0.08) !important; color: var(--text-100) !important; border-radius: 10px !important; }
            .ui-fileupload-buttonbar { background: transparent !important; border: none !important; }
            .ui-fileupload-choose { background: rgba(0,225,255,0.08) !important; border: 1px solid rgba(0,225,255,0.2) !important; color: var(--accent) !important; border-radius: 8px; }
            .ui-fileupload-choose:hover { background: rgba(0,225,255,0.15) !important; border-color: rgba(0,225,255,0.3) !important; }
            .ui-fileupload-choose .ui-button-icon-left { color: var(--accent) !important; }
            .ui-fileupload-content { background: transparent !important; }
            .ui-fileupload-row { background: transparent !important; border-color: rgba(255,255,255,0.08) !important; }
            .ui-fileupload-filename { color: var(--text-100) !important; }
            .ui-fileupload-buttonbar .ui-button { background: transparent !important; border: none !important; color: var(--text-100) !important; }
            .ui-fileupload-buttonbar .ui-button:hover { color: var(--accent) !important; }
        </style>
    </ui:define>
</ui:composition>
